install.packages("jtools")  
install.packages("huxtable")   
install.packages("readxl")
install.packages("dplyr")
install.packages("Hmisc")
install.packages("ggplot2")
library("ggplot2")
library(huxtable)
library(plyr)
library(dplyr)
library(readr)
library(jtools)
library(readxl)
library(Hmisc)

rm(list=ls())
food_coded <- read_csv("Desktop/RBS_Data_Analytics_Challenge_2021/Data_&_Description/food_coded.csv")
View(food_coded)

#run OLS against parents' education level
#case 1: college degree and above vs. non-college degree
gpa_college <- food_coded[c(1, 24, 44)]
gpa_college <- gpa_college[complete.cases(gpa_college),]
View(gpa_college)
gpa_college$father_education[gpa_college$father_education==1] <- 0 
gpa_college$father_education[gpa_college$father_education==2] <- 0
gpa_college$father_education[gpa_college$father_education==3] <- 0
gpa_college$father_education[gpa_college$father_education==4] <- 1
gpa_college$father_education[gpa_college$father_education==5] <- 1 

gpa_college$mother_education[gpa_college$mother_education==1] <- 0 
gpa_college$mother_education[gpa_college$mother_education==2] <- 0
gpa_college$mother_education[gpa_college$mother_education==3] <- 0
gpa_college$mother_education[gpa_college$mother_education==4] <- 1
gpa_college$mother_education[gpa_college$mother_education==5] <- 1 

as.numeric(as.character(gpa_college$GPA))
gpa_college <- gpa_college[!is.na(as.numeric(as.character(gpa_college$GPA))),]

fit <- lm(GPA ~ father_education + mother_education , data = gpa_college)
summary(fit)


#case2: advanced degree vs. non-advanced degree
gpa_advanced <- food_coded[c(1, 24, 44)]
View(gpa_advanced)
gpa_advanced <- gpa_advanced[complete.cases(gpa_advanced),]
gpa_advanced$father_education[gpa_advanced$father_education==1] <- 0 #1 is healthy diet, 0 is unhealthy diet
gpa_advanced$father_education[gpa_advanced$father_education==2] <- 0
gpa_advanced$father_education[gpa_advanced$father_education==3] <- 0
gpa_advanced$father_education[gpa_advanced$father_education==4] <- 0
gpa_advanced$father_education[gpa_advanced$father_education==5] <- 1 

gpa_advanced$mother_education[gpa_advanced$mother_education==1] <- 0 
gpa_advanced$mother_education[gpa_advanced$mother_education==2] <- 0
gpa_advanced$mother_education[gpa_advanced$mother_education==3] <- 0
gpa_advanced$mother_education[gpa_advanced$mother_education==4] <- 0
gpa_advanced$mother_education[gpa_advanced$mother_education==5] <- 1 

as.numeric(as.character(gpa_advanced$GPA))
gpa_advanced <- gpa_advanced[!is.na(as.numeric(as.character(gpa_advanced$GPA))),]

fit2 <- lm(GPA ~ father_education + mother_education , data = gpa_advanced)
summary(fit2)

#check joint significance
library(car)
null = c("mother_education", "father_education")
linearHypothesis(fit,null)

